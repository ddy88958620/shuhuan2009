<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.qiyi.videocloud.openplatform.dao.mapper.OpAppInfoMapper">
	<resultMap id="BaseResultMap" type="com.qiyi.videocloud.openplatform.domain.OpAppInfo" >
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="app_key" property="appKey" jdbcType="CHAR" />
    <result column="app_secret" property="appSecret" jdbcType="VARCHAR" />
    <result column="app_name" property="appName" jdbcType="VARCHAR" />
    <result column="app_status" property="appStatus" jdbcType="INTEGER" />
    <result column="is_auditing" property="isAuditing" jdbcType="INTEGER" />
    <result column="app_type" property="appType" jdbcType="INTEGER" />
    <result column="app_desc" property="appDesc" jdbcType="VARCHAR" />
    <result column="app_platforms" property="appPlatforms" jdbcType="VARCHAR" />
    <result column="app_homepage" property="appHomepage" jdbcType="VARCHAR" />
    <result column="app_tag" property="appTag" jdbcType="VARCHAR" />
    <result column="app_icon" property="appIcon" jdbcType="VARCHAR" />
    <result column="owner_type" property="ownerType" jdbcType="INTEGER" />
    <result column="owner_email" property="ownerEmail" jdbcType="VARCHAR" />
    <result column="owner_uid" property="ownerUid" jdbcType="BIGINT" />
    <result column="owner_phone" property="ownerPhone" jdbcType="VARCHAR" />
    <result column="owner_name" property="ownerName" jdbcType="VARCHAR" />
    <result column="owner_passport_number" property="ownerPassportNumber" jdbcType="VARCHAR" />
    <result column="owner_company_name" property="ownerCompanyName" jdbcType="VARCHAR" />
    <result column="owner_address" property="ownerAddress" jdbcType="VARCHAR" />
    <result column="app_total_quota" property="appTotalQuota" jdbcType="BIGINT" />
    <result column="app_quota_used" property="appQuotaUsed" jdbcType="BIGINT" />
    <result column="approve_time" property="approveTime" jdbcType="BIGINT" />
    <result column="approve_desc" property="approveDesc" jdbcType="VARCHAR" />
    <result column="create_time" property="createTime" jdbcType="BIGINT" />
    <result column="update_time" property="updateTime" jdbcType="BIGINT" />
    <result column="resource_ids" property="resourceIds" jdbcType="VARCHAR" />
    <result column="scope" property="scope" jdbcType="VARCHAR" />
    <result column="authorized_grant_types" property="authorizedGrantTypes" jdbcType="VARCHAR" />
    <result column="authorities" property="authorities" jdbcType="VARCHAR" />
    <result column="redirect_uri" property="redirectUri" jdbcType="VARCHAR" />
    <result column="access_token_validity" property="accessTokenValidity" jdbcType="INTEGER" />
    <result column="refresh_token_validity" property="refreshTokenValidity" jdbcType="INTEGER" />
    <result column="is_user_auth_required" property="isUserAuthRequired" jdbcType="INTEGER" />
    <result column="video_notify_url" property="videoNotifyUrl" jdbcType="VARCHAR" />
  </resultMap>
  
  <sql id="Base_Column_List" >
    id, app_key, app_secret, app_name, app_status, is_auditing, app_type, app_desc, app_platforms, 
    app_homepage, app_tag, app_icon, owner_type, owner_email, owner_uid, owner_phone, 
    owner_name, owner_passport_number, owner_company_name, owner_address, app_total_quota, 
    app_quota_used, approve_time, approve_desc, create_time, update_time, resource_ids, 
    scope, authorized_grant_types, authorities, redirect_uri, access_token_validity, 
    refresh_token_validity, is_user_auth_required, video_notify_url
  </sql>
  
  <sql id="User_Column_List" >
    id, app_name,  app_type, app_desc, app_platforms, 
    app_homepage, app_tag, app_icon,approve_time, create_time, update_time, is_user_auth_required
  </sql>

	<select id="selectByAppKey" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from op_app_info
		where app_key = #{appKey,jdbcType=CHAR}
		<if test="appStatus!=null">
		and app_status = #{appStatus}
		</if>
	</select>
	
	<select id="checkAppName" resultType="java.lang.Integer">
		select count(1)
		from  op_app_info
		where app_name = #{appName}
	</select>
	
	<select id="selectAppDetailByDeveloper" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from op_app_info
		where app_key = #{appKey,jdbcType=CHAR} and owner_uid=#{uid,jdbcType=BIGINT}
		<if test="appStatus!=null">
			and app_status = #{appStatus}
		</if>
	</select>
	
	<select id="selectByAppId" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from
		op_app_info
		where id = #{id}
	</select>
	
	<select id="selectAppForAuidt" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from op_app_request
		where app_status = 1 or app_status = 6
		order by id desc
		<if test="start!=null and offset!=null">
		limit #{start},#{offset}
		</if>
	</select>

	<select id="getAppListForDeveloper" resultMap="BaseResultMap">

		select
		<include refid="Base_Column_List" />
		from op_app_info
		where owner_uid = #{uid}
		order by id desc
		<if test="start!=null and offset!=null">
		limit #{start},#{offset}
		</if>	

	</select>

	<select id="getAppNumForDeveloper" resultType="long">
		select count(id)
		from op_app_info
		where owner_uid = #{uid}
	</select>
	
	<select id="getAppListForUser" resultMap="BaseResultMap">
		select a.id,a.app_key,a.app_status,a.app_name,a.app_type,a.app_desc,a.app_platforms,a.app_homepage,
		a.app_tag,a.app_icon,a.approve_time,a.create_time,a.update_time
		from op_app_info as a,oauth_access_token as t
		where t.uid=#{uid} and t.state=1 and t.app_key=a.app_key  and a.app_status = 2
		order by a.id desc
		<if test="start!=null and offset!=null">
		limit #{start},#{offset}
		</if>
		
	</select>

	<delete id="deleteByAppKey">
		update op_app_info
		set
		app_status = 5
		where app_key = #{appKey,jdbcType=CHAR}
		<if test="uid != null">
		and owner_uid = #{uid}
		</if>
	</delete>
	
	
	<update id="resetAppSecret">
		update op_app_info
		set
		app_secret = #{appSecret,jdbcType=CHAR}
		where app_key = #{appKey,jdbcType=CHAR}
		<if test="uid != null">
		and owner_uid = #{uid}
		</if>
	</update>

	<insert id="insertSelective" parameterType="com.qiyi.videocloud.openplatform.domain.OpAppInfo">

		insert into op_app_info
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				id,
			</if>
			<if test="appKey != null">
				app_key,
			</if>
			<if test="appSecret != null">
				app_secret,
			</if>
			<if test="appName != null">
				app_name,
			</if>
			<if test="appStatus != null">
				app_status,
			</if>
			<if test="isAuditing != null">
				is_auditing,
			</if>
			<if test="appType != null">
				app_type,
			</if>
			<if test="appDesc != null">
				app_desc,
			</if>
			<if test="appPlatforms != null">
				app_platforms,
			</if>
			<if test="appHomepage != null">
				app_homepage,
			</if>
			<if test="appTag != null">
				app_tag,
			</if>
			<if test="appIcon != null">
				app_icon,
			</if>
			<if test="ownerType != null">
				owner_type,
			</if>
			<if test="ownerEmail != null">
				owner_email,
			</if>
			<if test="ownerUid != null">
				owner_uid,
			</if>
			<if test="ownerPhone != null">
				owner_phone,
			</if>
			<if test="ownerName != null">
				owner_name,
			</if>
			<if test="ownerPassportNumber != null">
				owner_passport_number,
			</if>
			<if test="ownerCompanyName != null">
				owner_company_name,
			</if>
			<if test="ownerAddress != null">
				owner_address,
			</if>
			<if test="appTotalQuota != null">
				app_total_quota,
			</if>
			<if test="appQuotaUsed != null">
				app_quota_used,
			</if>
			<if test="approveTime != null">
				approve_time,
			</if>
			<if test="approveDesc != null">
				approve_desc,
			</if>
			<if test="createTime != null">
				create_time,
			</if>
			<if test="updateTime != null">
				update_time,
			</if>
			<if test="resourceIds != null">
				resource_ids,
			</if>
			<if test="scope != null">
				scope,
			</if>
			<if test="authorizedGrantTypes != null">
				authorized_grant_types,
			</if>
			<if test="authorities != null">
				authorities,
			</if>
			<if test="redirectUri != null">
				redirect_uri,
			</if>
			<if test="accessTokenValidity != null">
				access_token_validity,
			</if>
			<if test="refreshTokenValidity != null">
				refresh_token_validity,
			</if>
			<if test="isUserAuthRequired!=null">
				is_user_auth_required
			</if>
			<if test="videoNotifyUrl">
				video_notify_url
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=INTEGER},
			</if>
			<if test="appKey != null">
				#{appKey,jdbcType=CHAR},
			</if>
			<if test="appSecret != null">
				#{appSecret,jdbcType=VARCHAR},
			</if>
			<if test="appName != null">
				#{appName,jdbcType=VARCHAR},
			</if>
			<if test="appStatus != null">
				#{appStatus,jdbcType=INTEGER},
			</if>
			<if test="isAuditing!=null">
			    #{isAuditing,jdbcType=INTEGER},
			</if>
			<if test="appType != null">
				#{appType,jdbcType=INTEGER},
			</if>
			<if test="appDesc != null">
				#{appDesc,jdbcType=VARCHAR},
			</if>
			<if test="appPlatforms != null">
				#{appPlatforms,jdbcType=VARCHAR},
			</if>
			<if test="appHomepage != null">
				#{appHomepage,jdbcType=VARCHAR},
			</if>
			<if test="appTag != null">
				#{appTag,jdbcType=VARCHAR},
			</if>
			<if test="appIcon != null">
				#{appIcon,jdbcType=VARCHAR},
			</if>
			<if test="ownerType != null">
				#{ownerType,jdbcType=INTEGER},
			</if>
			<if test="ownerEmail != null">
				#{ownerEmail,jdbcType=VARCHAR},
			</if>
			<if test="ownerUid != null">
				#{ownerUid,jdbcType=BIGINT},
			</if>
			<if test="ownerPhone != null">
				#{ownerPhone,jdbcType=VARCHAR},
			</if>
			<if test="ownerName != null">
				#{ownerName,jdbcType=VARCHAR},
			</if>
			<if test="ownerPassportNumber != null">
				#{ownerPassportNumber,jdbcType=VARCHAR},
			</if>
			<if test="ownerCompanyName != null">
				#{ownerCompanyName,jdbcType=VARCHAR},
			</if>
			<if test="ownerAddress != null">
				#{ownerAddress,jdbcType=VARCHAR},
			</if>
			<if test="appTotalQuota != null">
				#{appTotalQuota,jdbcType=BIGINT},
			</if>
			<if test="appQuotaUsed != null">
				#{appQuotaUsed,jdbcType=BIGINT},
			</if>
			<if test="approveTime != null">
				#{approveTime,jdbcType=BIGINT},
			</if>
			<if test="approveDesc != null">
				#{approveDesc,jdbcType=VARCHAR},
			</if>
			<if test="createTime != null">
				#{createTime,jdbcType=BIGINT},
			</if>
			<if test="updateTime != null">
				#{updateTime,jdbcType=BIGINT},
			</if>
			<if test="resourceIds != null">
				#{resourceIds,jdbcType=VARCHAR},
			</if>
			<if test="scope != null">
				#{scope,jdbcType=VARCHAR},
			</if>
			<if test="authorizedGrantTypes != null">
				#{authorizedGrantTypes,jdbcType=VARCHAR},
			</if>
			<if test="authorities != null">
				#{authorities,jdbcType=VARCHAR},
			</if>
			<if test="redirectUri != null">
				#{redirectUri,jdbcType=VARCHAR},
			</if>
			<if test="accessTokenValidity != null">
				#{accessTokenValidity,jdbcType=INTEGER},
			</if>
			<if test="refreshTokenValidity != null">
				#{refreshTokenValidity,jdbcType=INTEGER},
			</if>
			<if test="isUserAuthRequired!=null">
				#{isUserAuthRequired,jdbcType=INTEGER},
			</if>
			<if test="videoNotifyUrl">
				#{videoNotifyUrl,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>

	<select id="getRequestById" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from op_app_request
		where id = #{id,jdbcType=INTEGER}
	</select>

	<insert id="insertForAuditing" parameterType="com.qiyi.videocloud.openplatform.domain.OpAppInfo">
		insert into op_app_request
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="appKey != null">
				app_key,
			</if>
			<if test="appSecret != null">
				app_secret,
			</if>
			<if test="appName != null">
				app_name,
			</if>
			<if test="appStatus != null">
				app_status,
			</if>
			<if test="isAuditing != null">
				is_auditing,
			</if>
			<if test="appType != null">
				app_type,
			</if>
			<if test="appDesc != null">
				app_desc,
			</if>
			<if test="appPlatforms != null">
				app_platforms,
			</if>
			<if test="appHomepage != null">
				app_homepage,
			</if>
			<if test="appTag != null">
				app_tag,
			</if>
			<if test="appIcon != null">
				app_icon,
			</if>
			<if test="ownerType != null">
				owner_type,
			</if>
			<if test="ownerEmail != null">
				owner_email,
			</if>
			<if test="ownerUid != null">
				owner_uid,
			</if>
			<if test="ownerPhone != null">
				owner_phone,
			</if>
			<if test="ownerName != null">
				owner_name,
			</if>
			<if test="ownerPassportNumber != null">
				owner_passport_number,
			</if>
			<if test="ownerCompanyName != null">
				owner_company_name,
			</if>
			<if test="ownerAddress != null">
				owner_address,
			</if>
			<if test="appTotalQuota != null">
				app_total_quota,
			</if>
			<if test="appQuotaUsed != null">
				app_quota_used,
			</if>
			<if test="approveTime != null">
				approve_time,
			</if>
			<if test="approveDesc != null">
				approve_desc,
			</if>
			<if test="createTime != null">
				create_time,
			</if>
			<if test="updateTime != null">
				update_time,
			</if>
			<if test="resourceIds != null">
				resource_ids,
			</if>
			<if test="scope != null">
				scope,
			</if>
			<if test="authorizedGrantTypes != null">
				authorized_grant_types,
			</if>
			<if test="authorities != null">
				authorities,
			</if>
			<if test="redirectUri != null">
				redirect_uri,
			</if>
			<if test="accessTokenValidity != null">
				access_token_validity,
			</if>
			<if test="refreshTokenValidity != null">
				refresh_token_validity,
			</if>
			<if test="isUserAuthRequired!=null">
				is_user_auth_required
			</if>
			<if test="videoNotifyUrl">
				video_notify_url
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="appKey != null">
				#{appKey,jdbcType=CHAR},
			</if>
			<if test="appSecret != null">
				#{appSecret,jdbcType=VARCHAR},
			</if>
			<if test="appName != null">
				#{appName,jdbcType=VARCHAR},
			</if>
			<if test="appStatus != null">
				#{appStatus,jdbcType=INTEGER},
			</if>
			<if test="isAuditing!=null">
			    #{isAuditing,jdbcType=INTEGER},
			</if>
			<if test="appType != null">
				#{appType,jdbcType=INTEGER},
			</if>
			<if test="appDesc != null">
				#{appDesc,jdbcType=VARCHAR},
			</if>
			<if test="appPlatforms != null">
				#{appPlatforms,jdbcType=VARCHAR},
			</if>
			<if test="appHomepage != null">
				#{appHomepage,jdbcType=VARCHAR},
			</if>
			<if test="appTag != null">
				#{appTag,jdbcType=VARCHAR},
			</if>
			<if test="appIcon != null">
				#{appIcon,jdbcType=VARCHAR},
			</if>
			<if test="ownerType != null">
				#{ownerType,jdbcType=INTEGER},
			</if>
			<if test="ownerEmail != null">
				#{ownerEmail,jdbcType=VARCHAR},
			</if>
			<if test="ownerUid != null">
				#{ownerUid,jdbcType=BIGINT},
			</if>
			<if test="ownerPhone != null">
				#{ownerPhone,jdbcType=VARCHAR},
			</if>
			<if test="ownerName != null">
				#{ownerName,jdbcType=VARCHAR},
			</if>
			<if test="ownerPassportNumber != null">
				#{ownerPassportNumber,jdbcType=VARCHAR},
			</if>
			<if test="ownerCompanyName != null">
				#{ownerCompanyName,jdbcType=VARCHAR},
			</if>
			<if test="ownerAddress != null">
				#{ownerAddress,jdbcType=VARCHAR},
			</if>
			<if test="appTotalQuota != null">
				#{appTotalQuota,jdbcType=BIGINT},
			</if>
			<if test="appQuotaUsed != null">
				#{appQuotaUsed,jdbcType=BIGINT},
			</if>
			<if test="approveTime != null">
				#{approveTime,jdbcType=BIGINT},
			</if>
			<if test="approveDesc != null">
				#{approveDesc,jdbcType=VARCHAR},
			</if>
			<if test="createTime != null">
				#{createTime,jdbcType=BIGINT},
			</if>
			<if test="updateTime != null">
				#{updateTime,jdbcType=BIGINT},
			</if>
			<if test="resourceIds != null">
				#{resourceIds,jdbcType=VARCHAR},
			</if>
			<if test="scope != null">
				#{scope,jdbcType=VARCHAR},
			</if>
			<if test="authorizedGrantTypes != null">
				#{authorizedGrantTypes,jdbcType=VARCHAR},
			</if>
			<if test="authorities != null">
				#{authorities,jdbcType=VARCHAR},
			</if>
			<if test="redirectUri != null">
				#{redirectUri,jdbcType=VARCHAR},
			</if>
			<if test="accessTokenValidity != null">
				#{accessTokenValidity,jdbcType=INTEGER},
			</if>
			<if test="refreshTokenValidity != null">
				#{refreshTokenValidity,jdbcType=INTEGER},
			</if>
			<if test="isUserAuthRequired!=null">
				#{isUserAuthRequired,jdbcType=INTEGER},
			</if>
			<if test="videoNotifyUrl">
				#{videoNotifyUrl,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>
	
	<update id="updateByAppDeveloperSelective" parameterType="com.qiyi.videocloud.openplatform.domain.OpAppInfo">

		update op_app_info

		<set>

			<if test="appSecret != null">
				app_secret = #{appSecret,jdbcType=VARCHAR},
			</if>
			<if test="appName != null">
				app_name = #{appName,jdbcType=VARCHAR},
			</if>
			<if test="appStatus != null">
				app_status = #{appStatus,jdbcType=INTEGER},
			</if>
			<if test="appType != null">
				app_type = #{appType,jdbcType=INTEGER},
			</if>
			<if test="appDesc != null">
				app_desc = #{appDesc,jdbcType=VARCHAR},
			</if>
			<if test="appPlatforms != null">
				app_platforms = #{appPlatforms,jdbcType=VARCHAR},
			</if>
			<if test="appHomepage != null">
				app_homepage = #{appHomepage,jdbcType=VARCHAR},
			</if>
			<if test="appTag != null">
				app_tag = #{appTag,jdbcType=VARCHAR},
			</if>
			<if test="appIcon != null">
				app_icon = #{appIcon,jdbcType=VARCHAR},
			</if>
			<if test="ownerType != null">
				owner_type = #{ownerType,jdbcType=INTEGER},
			</if>
			<if test="ownerEmail != null">
				owner_email = #{ownerEmail,jdbcType=VARCHAR},
			</if>
			<if test="ownerPhone != null">
				owner_phone = #{ownerPhone,jdbcType=VARCHAR},
			</if>
			<if test="ownerName != null">
				owner_name = #{ownerName,jdbcType=VARCHAR},
			</if>
			<if test="ownerPassportNumber != null">
				owner_passport_number =
				#{ownerPassportNumber,jdbcType=VARCHAR},
			</if>
			<if test="ownerCompanyName != null">
				owner_company_name =
				#{ownerCompanyName,jdbcType=VARCHAR},
			</if>
			<if test="ownerAddress != null">
				owner_address = #{ownerAddress,jdbcType=VARCHAR},
			</if>
			<if test="appTotalQuota != null">
				app_total_quota = #{appTotalQuota,jdbcType=BIGINT},
			</if>
			<if test="appQuotaUsed != null">
				app_quota_used = #{appQuotaUsed,jdbcType=BIGINT},
			</if>
			<if test="approveTime != null">
				approve_time = #{approveTime,jdbcType=BIGINT},
			</if>
			<if test="approveDesc != null">
				approve_desc = #{approveDesc,jdbcType=VARCHAR},
			</if>
			<if test="createTime != null">
				create_time = #{createTime,jdbcType=BIGINT},
			</if>
			<if test="updateTime != null">
				update_time = #{updateTime,jdbcType=BIGINT},
			</if>
			<if test="resourceIds != null">
				resource_ids = #{resourceIds,jdbcType=VARCHAR},
			</if>
			<if test="scope != null">
				scope = #{scope,jdbcType=VARCHAR},
			</if>
			<if test="authorizedGrantTypes != null">
				authorized_grant_types =
				#{authorizedGrantTypes,jdbcType=VARCHAR},
			</if>
			<if test="authorities != null">
				authorities = #{authorities,jdbcType=VARCHAR},
			</if>
			<if test="redirectUri != null">
				redirect_uri = #{redirectUri,jdbcType=VARCHAR},
			</if>
			<if test="accessTokenValidity != null">
				access_token_validity =
				#{accessTokenValidity,jdbcType=INTEGER},
			</if>
			<if test="refreshTokenValidity != null">
				refresh_token_validity =
				#{refreshTokenValidity,jdbcType=INTEGER},
			</if>
			<if test="isUserAuthRequired!=null">
				is_user_auth_required =
				#{isUserAuthRequired,jdbcType=INTEGER},
			</if>
			<if test="videoNotifyUrl">
				video_notify_url =
				#{videoNotifyUrl,jdbcType=VARCHAR},
			</if>
		</set>
		where app_key = #{appKey,jdbcType=CHAR} and owner_uid=#{ownerUid,jdbcType=BIGINT}
	</update>
	
	<update id="addAppQuotaUsag">
	  update op_app_info
	  set app_quota_used = app_quota_used + #{quota}
	  where app_key=#{appKey}
	</update>
	
	<update id="updateByAppKeySelective" parameterType="com.qiyi.videocloud.openplatform.domain.OpAppInfo">

		update op_app_info

		<set>

			<if test="appSecret != null">
				app_secret = #{appSecret,jdbcType=VARCHAR},
			</if>
			<if test="appName != null">
				app_name = #{appName,jdbcType=VARCHAR},
			</if>
			<if test="appStatus != null">
				app_status = #{appStatus,jdbcType=INTEGER},
			</if>
			<if test="isAuditing !=null">
				is_auditing = #{isAuditing,jdbcType=INTEGER},
			</if>
			<if test="appType != null">
				app_type = #{appType,jdbcType=INTEGER},
			</if>
			<if test="appDesc != null">
				app_desc = #{appDesc,jdbcType=VARCHAR},
			</if>
			<if test="appPlatforms != null">
				app_platforms = #{appPlatforms,jdbcType=VARCHAR},
			</if>
			<if test="appHomepage != null">
				app_homepage = #{appHomepage,jdbcType=VARCHAR},
			</if>
			<if test="appTag != null">
				app_tag = #{appTag,jdbcType=VARCHAR},
			</if>
			<if test="appIcon != null">
				app_icon = #{appIcon,jdbcType=VARCHAR},
			</if>
			<if test="ownerType != null">
				owner_type = #{ownerType,jdbcType=INTEGER},
			</if>
			<if test="ownerEmail != null">
				owner_email = #{ownerEmail,jdbcType=VARCHAR},
			</if>
			<if test="ownerUid != null">
				owner_uid = #{ownerUid,jdbcType=BIGINT},
			</if>
			<if test="ownerPhone != null">
				owner_phone = #{ownerPhone,jdbcType=VARCHAR},
			</if>
			<if test="ownerName != null">
				owner_name = #{ownerName,jdbcType=VARCHAR},
			</if>
			<if test="ownerPassportNumber != null">
				owner_passport_number =
				#{ownerPassportNumber,jdbcType=VARCHAR},
			</if>
			<if test="ownerCompanyName != null">
				owner_company_name =
				#{ownerCompanyName,jdbcType=VARCHAR},
			</if>
			<if test="ownerAddress != null">
				owner_address = #{ownerAddress,jdbcType=VARCHAR},
			</if>
			<if test="appTotalQuota != null">
				app_total_quota = #{appTotalQuota,jdbcType=BIGINT},
			</if>
			<if test="appQuotaUsed != null">
				app_quota_used = #{appQuotaUsed,jdbcType=BIGINT},
			</if>
			<if test="approveTime != null">
				approve_time = #{approveTime,jdbcType=BIGINT},
			</if>
			<if test="approveDesc != null">
				approve_desc = #{approveDesc,jdbcType=VARCHAR},
			</if>
			<if test="createTime != null">
				create_time = #{createTime,jdbcType=BIGINT},
			</if>
			<if test="updateTime != null">
				update_time = #{updateTime,jdbcType=BIGINT},
			</if>
			<if test="resourceIds != null">
				resource_ids = #{resourceIds,jdbcType=VARCHAR},
			</if>
			<if test="scope != null">
				scope = #{scope,jdbcType=VARCHAR},
			</if>
			<if test="authorizedGrantTypes != null">
				authorized_grant_types =
				#{authorizedGrantTypes,jdbcType=VARCHAR},
			</if>
			<if test="authorities != null">
				authorities = #{authorities,jdbcType=VARCHAR},
			</if>
			<if test="redirectUri != null">
				redirect_uri = #{redirectUri,jdbcType=VARCHAR},
			</if>
			<if test="accessTokenValidity != null">
				access_token_validity =
				#{accessTokenValidity,jdbcType=INTEGER},
			</if>
			<if test="refreshTokenValidity != null">
				refresh_token_validity =
				#{refreshTokenValidity,jdbcType=INTEGER},
			</if>
			<if test="isUserAuthRequired!=null">
				is_user_auth_required =
				#{isUserAuthRequired,jdbcType=INTEGER},
			</if>
			<if test="videoNotifyUrl">
				video_notify_url =
				#{videoNotifyUrl,jdbcType=VARCHAR},
			</if>
		</set>
		where app_key = #{appKey,jdbcType=CHAR}
	</update>
	
	<select id="getAppInfoByToken" resultType="String">
	
		SELECT
			OPI.*
		FROM
			oauth_access_token OAT
		INNER JOIN op_app_info OPI 
		ON OAT.app_key = OPI.app_key
		WHERE
			OAT.access_token = #{accessToken}
		AND OAT.state = 1
	
	</select>
	
	<select id="selectAppByStatus" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from op_app_info
		where app_status = #{appStatus}
		order by id desc
		<if test="start!=null and offset!=null">
		limit #{start},#{offset}
		</if>
	</select>


</mapper>